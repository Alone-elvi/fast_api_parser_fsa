#!/bin/bash
set -e

# Ждем готовности PostgreSQL
until pg_isready -U "$POSTGRES_USER"; do
    echo "Waiting for PostgreSQL to start..."
    sleep 2
done

# Применяем миграции
echo "Creating database and tables..."

# Создаем базу данных и таблицы
psql -v ON_ERROR_STOP=1 --username "$POSTGRES_USER" --dbname "$POSTGRES_DB" -f /docker-entrypoint-initdb.d/init.sql

echo "Database initialization completed."
